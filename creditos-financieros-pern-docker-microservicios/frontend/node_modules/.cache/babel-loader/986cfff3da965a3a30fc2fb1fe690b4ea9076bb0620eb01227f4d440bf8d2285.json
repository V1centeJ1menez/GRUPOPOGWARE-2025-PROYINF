{"ast":null,"code":"// Utilidades para historial local (cookie + localStorage)\n// Estrategia:\n// - Cookie \"sim_hist_idx\": JSON con { ids: string[], lastPendingId?: string }\n// - localStorage items \"sim_hist:{id}\": simulación completa\n// - localStorage key \"pending_simulation\": simulación a continuar tras registro\n\nconst COOKIE_NAME = \"sim_hist_idx\";\nconst COOKIE_MAX_AGE = 60 * 60 * 24 * 180; // 180 días\n\nfunction setCookie(name, value, maxAgeSec = COOKIE_MAX_AGE) {\n  document.cookie = `${name}=${encodeURIComponent(value)}; path=/; max-age=${maxAgeSec}`;\n}\nfunction getCookie(name) {\n  const m = document.cookie.match(new RegExp(`(?:^|; )${name}=([^;]*)`));\n  return m ? decodeURIComponent(m[1]) : null;\n}\nfunction readIndex() {\n  try {\n    const raw = getCookie(COOKIE_NAME);\n    if (!raw) return {\n      ids: []\n    };\n    const parsed = JSON.parse(raw);\n    if (!Array.isArray(parsed.ids)) return {\n      ids: []\n    };\n    return parsed;\n  } catch {\n    return {\n      ids: []\n    };\n  }\n}\nfunction writeIndex(idx) {\n  setCookie(COOKIE_NAME, JSON.stringify(idx));\n}\nfunction saveItem(id, data) {\n  localStorage.setItem(`sim_hist:${id}`, JSON.stringify(data));\n}\nfunction loadItem(id) {\n  const raw = localStorage.getItem(`sim_hist:${id}`);\n  return raw ? JSON.parse(raw) : null;\n}\nfunction removeItem(id) {\n  localStorage.removeItem(`sim_hist:${id}`);\n}\nexport function addSimulation(sim) {\n  const id = sim.id || crypto.randomUUID();\n  const fecha = sim.fecha || new Date().toISOString();\n  const full = {\n    ...sim,\n    id,\n    fecha\n  };\n  saveItem(id, full);\n  const idx = readIndex();\n  const ids = [id, ...idx.ids.filter(x => x !== id)].slice(0, 50); // conservar últimas 50\n  writeIndex({\n    ...idx,\n    ids\n  });\n  return full;\n}\nexport function getHistory(limit = null) {\n  const idx = readIndex();\n  const items = idx.ids.map(loadItem).filter(Boolean);\n  return limit ? items.slice(0, limit) : items;\n}\nexport function deleteFromHistory(id) {\n  const idx = readIndex();\n  writeIndex({\n    ...idx,\n    ids: idx.ids.filter(x => x !== id),\n    lastPendingId: idx.lastPendingId === id ? undefined : idx.lastPendingId\n  });\n  removeItem(id);\n}\nexport function clearHistory() {\n  const idx = readIndex();\n  idx.ids.forEach(removeItem);\n  writeIndex({\n    ids: []\n  });\n}\nexport function setPendingSimulation(sim) {\n  const saved = addSimulation(sim);\n  localStorage.setItem(\"pending_simulation\", JSON.stringify(saved));\n  const idx = readIndex();\n  writeIndex({\n    ...idx,\n    lastPendingId: saved.id\n  });\n  return saved;\n}\nexport function getPendingSimulation() {\n  const raw = localStorage.getItem(\"pending_simulation\");\n  if (!raw) return null;\n  try {\n    return JSON.parse(raw);\n  } catch {\n    return null;\n  }\n}\nexport function popPendingSimulation() {\n  const sim = getPendingSimulation();\n  localStorage.removeItem(\"pending_simulation\");\n  const idx = readIndex();\n  if (idx.lastPendingId) writeIndex({\n    ...idx,\n    lastPendingId: undefined\n  });\n  return sim;\n}","map":{"version":3,"names":["COOKIE_NAME","COOKIE_MAX_AGE","setCookie","name","value","maxAgeSec","document","cookie","encodeURIComponent","getCookie","m","match","RegExp","decodeURIComponent","readIndex","raw","ids","parsed","JSON","parse","Array","isArray","writeIndex","idx","stringify","saveItem","id","data","localStorage","setItem","loadItem","getItem","removeItem","addSimulation","sim","crypto","randomUUID","fecha","Date","toISOString","full","filter","x","slice","getHistory","limit","items","map","Boolean","deleteFromHistory","lastPendingId","undefined","clearHistory","forEach","setPendingSimulation","saved","getPendingSimulation","popPendingSimulation"],"sources":["/home/numpi/Documentos/Semestre 6/Anal/GRUPOPOGWARE-2025-PROYINF/creditos-financieros-pern-docker-microservicios/frontend/src/features/simulacion/utils/localHistory.js"],"sourcesContent":["// Utilidades para historial local (cookie + localStorage)\n// Estrategia:\n// - Cookie \"sim_hist_idx\": JSON con { ids: string[], lastPendingId?: string }\n// - localStorage items \"sim_hist:{id}\": simulación completa\n// - localStorage key \"pending_simulation\": simulación a continuar tras registro\n\nconst COOKIE_NAME = \"sim_hist_idx\";\nconst COOKIE_MAX_AGE = 60 * 60 * 24 * 180; // 180 días\n\nfunction setCookie(name, value, maxAgeSec = COOKIE_MAX_AGE) {\n  document.cookie = `${name}=${encodeURIComponent(value)}; path=/; max-age=${maxAgeSec}`;\n}\n\nfunction getCookie(name) {\n  const m = document.cookie.match(new RegExp(`(?:^|; )${name}=([^;]*)`));\n  return m ? decodeURIComponent(m[1]) : null;\n}\n\nfunction readIndex() {\n  try {\n    const raw = getCookie(COOKIE_NAME);\n    if (!raw) return { ids: [] };\n    const parsed = JSON.parse(raw);\n    if (!Array.isArray(parsed.ids)) return { ids: [] };\n    return parsed;\n  } catch {\n    return { ids: [] };\n  }\n}\n\nfunction writeIndex(idx) {\n  setCookie(COOKIE_NAME, JSON.stringify(idx));\n}\n\nfunction saveItem(id, data) {\n  localStorage.setItem(`sim_hist:${id}`, JSON.stringify(data));\n}\n\nfunction loadItem(id) {\n  const raw = localStorage.getItem(`sim_hist:${id}`);\n  return raw ? JSON.parse(raw) : null;\n}\n\nfunction removeItem(id) {\n  localStorage.removeItem(`sim_hist:${id}`);\n}\n\nexport function addSimulation(sim) {\n  const id = sim.id || crypto.randomUUID();\n  const fecha = sim.fecha || new Date().toISOString();\n  const full = { ...sim, id, fecha };\n  saveItem(id, full);\n  const idx = readIndex();\n  const ids = [id, ...idx.ids.filter((x) => x !== id)].slice(0, 50); // conservar últimas 50\n  writeIndex({ ...idx, ids });\n  return full;\n}\n\nexport function getHistory(limit = null) {\n  const idx = readIndex();\n  const items = idx.ids.map(loadItem).filter(Boolean);\n  return limit ? items.slice(0, limit) : items;\n}\n\nexport function deleteFromHistory(id) {\n  const idx = readIndex();\n  writeIndex({ ...idx, ids: idx.ids.filter((x) => x !== id), lastPendingId: idx.lastPendingId === id ? undefined : idx.lastPendingId });\n  removeItem(id);\n}\n\nexport function clearHistory() {\n  const idx = readIndex();\n  idx.ids.forEach(removeItem);\n  writeIndex({ ids: [] });\n}\n\nexport function setPendingSimulation(sim) {\n  const saved = addSimulation(sim);\n  localStorage.setItem(\"pending_simulation\", JSON.stringify(saved));\n  const idx = readIndex();\n  writeIndex({ ...idx, lastPendingId: saved.id });\n  return saved;\n}\n\nexport function getPendingSimulation() {\n  const raw = localStorage.getItem(\"pending_simulation\");\n  if (!raw) return null;\n  try {\n    return JSON.parse(raw);\n  } catch {\n    return null;\n  }\n}\n\nexport function popPendingSimulation() {\n  const sim = getPendingSimulation();\n  localStorage.removeItem(\"pending_simulation\");\n  const idx = readIndex();\n  if (idx.lastPendingId) writeIndex({ ...idx, lastPendingId: undefined });\n  return sim;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}